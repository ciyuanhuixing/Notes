# 类的继承与多态

## 类的继承

### 类继承的特点

- `object`类型处在所有其他类型的继承链顶端，所以其他类型的实例都是`object`的实例。
- 子类的实例一定是其父类的实例，父类的实例不一定是其子类的实例。
- 可以用父类类型的变量来引用子类类型的实例，但反过来不可以。
- `sealed`类不能被继承。
- 只能有一个基类，但可以实现多个其接口。
- 子类的访问级别不能超越父类。	

### 继承的本质

类的继承的本质是类在功能上的扩展（extend），即派生类在基类已有的成员的基础之上对基类进行的横向和纵向上的扩展：

- 继承后的类成员只能增加不能移除。
- 横向扩展指的是对类成员个数的扩充。
- 纵向扩展指的是对类成员的版本的更新，或者说对类成员的重写。

### 类成员的继承

派生类对继承成员的访问：继承的成员不管使用`this`还是`base`访问效果都相同。

派生类对基类成员的访问：`base`关键字表示父类对象，最多只能访问上一级父类的对象，不能访问父类的父类对象。

构造器的不可继承性：

- 当构造子类对象时，其父类的构造器也会被调用，所以要保证父类的构造器也能被成功调用。
- 当父类只有参数不为空的构造器时，子类构造器在声明时要传参数给父类构造器。

## 类的访问控制

- `public`：在项目外也能访问。
- `internal`：默认级别，在同项目（项目也就是程序集或 Assembly）中能够访问。

## 类成员的访问控制

类的成员的访问级别是以该类的访问级别为上限的，在此前提下：

- `public`：在项目外也能访问。
- `internal`：在同项目中能够访问。
- `protected`：访问级别限制在继承链上，即允许该类和它的子孙类访问。
- `private`：默认级别，只能在类中访问。私有字段命名时推荐加上`_`前缀。
- `internal`和`protected`可以一起用，当它们一起用时是「或」的关系。

## 重写、隐藏

类成员的重写与隐藏的发生条件：

- 是函数成员。
- 可见（对子类可见）。
- 签名一致。

类成员重写：父类成员用`virtual`修饰，子类成员用`override`修饰。

类成员的隐藏指可重写的子类成员没有用`override`修饰时。父类成员被子类成员隐藏后，用子类变量引用子类实例时，调用到的成员是子类成员。

## 多态

多态（polymorphism）基于重写机制。多态指函数成员的具体行为（版本）由对象决定。

当用父类变量引用子类的实例时，能够调用的类成员版本是跟子类实例相关的，而且是继承链上最新的版本，注意如果子类的成员没有用`override`修饰，则这个子类成员就不在继承链上，而是把父类成员隐藏了，所以它不会被父类变量调用到。

之所以有多态的现象，是因为 C# 语言的变量和对象都是有类型的，产生了「代差」，Python 和 JavaScript 则是变量的类型随对象的类型动态改变，所以在语言层面上不能表现出多态。

